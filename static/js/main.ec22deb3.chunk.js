(this.webpackJsonpmovies=this.webpackJsonpmovies||[]).push([[0],{116:function(e,t,n){},117:function(e,t,n){},118:function(e,t,n){"use strict";n.r(t);var c=n(147),r=n(0),i=n.n(r),o=n(32),a=n.n(o),s=n(41),d=n(151),l=n(144),u=n(133),j=n(134),m=n(150),h=n(47),b=n(48),f=n(89),x=n(88),O=n(148),v=n(135),g=n(2),p=function(e){Object(f.a)(n,e);var t=Object(x.a)(n);function n(e){var c;return Object(h.a)(this,n),(c=t.call(this,e)).state={hasError:!1},c}return Object(b.a)(n,[{key:"render",value:function(){return this.state.hasError?Object(g.jsx)(u.a,{bgColor:"#EFEDFA",height:"100vh",children:Object(g.jsxs)(j.a,{children:[Object(g.jsx)(O.a,{src:"/error.png",alt:"Ice Cream",maxWidth:"25rem"}),Object(g.jsx)(v.a,{textAlign:"center",color:"#9b8875",fontWeight:600,fontSize:"1.5rem",children:"An unexpected error occurred. We'll fix it soon."})]})}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0,error:e}}}]),n}(i.a.Component),C=n(3),I=n(149),y=n(146),S=n(140),w=n(139),T=n(136),k=n(143),M=n(137),P=n(145),W=n(36),E=n.n(W),F=n(59),D=n(71),L=n(27),A=Object(L.b)("movies/fetchMoviesDataStatus",function(){var e=Object(F.a)(E.a.mark((function e(t,n){var c,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://yts.mx/api/v2/list_movies.json?limit=".concat(10,"&page=").concat(t));case 2:return c=e.sent,e.next=5,c.json();case 5:if("ok"===(r=e.sent).status){e.next=8;break}return e.abrupt("return",n.rejectWithValue(new Error("Error occured while movies was fetched.")));case 8:return e.abrupt("return",r.data);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),J=Object(L.c)({name:"movies",initialState:{movies:[],isLoading:"idle",totalCountOfMovies:0},reducers:{changeMovies:function(e,t){e.movies=t.payload},appendComment:function(e,t){var n,c=t.payload,r=c.movieId,i=c.content,o=e.movies.find((function(e){return e.id===r}));o&&(o.comments.push({id:((null===(n=o.comments[o.comments.length-1])||void 0===n?void 0:n.id)||0)+1,content:i}),localStorage.setItem(r.toString(),JSON.stringify(o.comments)))},deleteComment:function(e,t){var n=t.payload,c=n.movieId,r=n.commentId,i=e.movies.find((function(e){return e.id===c}));i&&(i.comments=i.comments.filter((function(e){return e.id!==r})),localStorage.setItem(c.toString(),JSON.stringify(i.comments)))}},extraReducers:function(e){e.addCase(A.fulfilled,(function(e,t){var n=t.payload;e.isLoading="idle",e.movies=n.movies.map((function(e){var t=JSON.parse(localStorage.getItem(e.id.toString())||"[]");return Object(D.a)(Object(D.a)({},e),{},{comments:t})})),e.totalCountOfMovies=n.movie_count})),e.addCase(A.rejected,(function(e,t){var n=t.payload;e.isLoading="idle",e.error=n})),e.addCase(A.pending,(function(e){e.isLoading="loading"}))}}),N=J.actions,_=N.appendComment,H=N.deleteComment,R=J.reducer,z=Object(L.c)({name:"moviesTable",initialState:{selectedMovieId:-1,commentInputText:""},reducers:{changeSelectedMovieId:function(e,t){e.selectedMovieId=t.payload},changeCommentInputText:function(e,t){e.commentInputText=t.payload}}}),B=z.actions,G=B.changeSelectedMovieId,V=B.changeCommentInputText,Y=z.reducer,q=Object(L.c)({name:"pagination",initialState:{currentPage:1},reducers:{changeCurrentPage:function(e,t){e.currentPage=t.payload}}}),K=q.actions.changeCurrentPage,Q=q.reducer,U=function(){return Object(s.b)()},X=s.c,Z=function(){var e=U();return{movies:X((function(e){return e.moviesData.movies})),isLoading:X((function(e){return e.moviesData.isLoading})),totalCountOfMovies:X((function(e){return e.moviesData.totalCountOfMovies})),moviesFetchError:X((function(e){return e.moviesData.error})),addComment:function(t,n){e(_({movieId:t,content:n}))},removeComment:function(t,n){e(H({movieId:t,commentId:n}))}}},$=(n(116),function(e){var t=e.movies,n=Object(y.a)(),c=n.isOpen,r=n.onOpen,i=n.onClose,o=Object(T.a)("(min-width: 920px)"),a=Object(C.a)(o,1)[0],s=Z(),d=s.addComment,u=s.removeComment,j=function(){var e=U();return{selectedMovieId:X((function(e){return e.moviesTable.selectedMovieId})),commentInputText:X((function(e){return e.moviesTable.commentInputText})),setSelectedMovieId:function(t){e(G(t))},setCommentInputText:function(t){e(V(t))}}}(),m=j.selectedMovieId,h=j.setSelectedMovieId,b=j.commentInputText,f=j.setCommentInputText,x=t.find((function(e){return e.id===m}));return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)(M.a,{variant:"simple",children:[a&&Object(g.jsx)(M.e,{children:Object(g.jsxs)(M.f,{children:[Object(g.jsx)(M.d,{minWidth:"16rem",children:"Poster"}),Object(g.jsx)(M.d,{minWidth:"10rem",children:"Title"}),Object(g.jsx)(M.d,{children:"Genres"}),Object(g.jsx)(M.d,{minWidth:"13rem",children:"Synopsis"}),Object(g.jsx)(M.d,{children:"Comments"})]})}),Object(g.jsx)(M.b,{children:t.map((function(e,t){return Object(g.jsxs)(M.f,{borderTop:0!==t?"1px solid #7b7b7b":"none",children:[Object(g.jsxs)(M.c,{maxHeight:"19rem",d:a?"table-cell":"flex",justifyContent:"space-between",children:[!a&&Object(g.jsx)(v.a,{fontWeight:600,children:"Poster"}),Object(g.jsx)(O.a,{src:e.medium_cover_image,alt:e.title,width:"11rem"})]}),Object(g.jsxs)(M.c,{d:a?"table-cell":"flex",justifyContent:"space-between",children:[!a&&Object(g.jsx)(v.a,{fontWeight:600,children:"Title"}),Object(g.jsx)(v.a,{children:e.title})]}),Object(g.jsxs)(M.c,{d:a?"table-cell":"flex",justifyContent:"space-between",children:[!a&&Object(g.jsx)(v.a,{fontWeight:600,children:"Genres"}),Object(g.jsx)(v.a,{maxWidth:a?"100%":"70%",children:e.genres.join(", ")})]}),Object(g.jsxs)(M.c,{d:a?"table-cell":"flex",justifyContent:"space-between",children:[!a&&Object(g.jsx)(v.a,{fontWeight:600,children:"Synopsis"}),Object(g.jsx)(v.a,{maxWidth:a?"90%":"70%",textAlign:"justify",children:e.synopsis})]}),Object(g.jsxs)(M.c,{d:a?"table-cell":"flex",justifyContent:"space-between",alignItems:"center",children:[!a&&Object(g.jsx)(v.a,{fontWeight:600,children:"Comments"}),Object(g.jsx)(I.a,{onClick:function(){return t=e.id,h(t),void r();var t},children:"Show"})]})]},e.id)}))})]}),Object(g.jsxs)(k.a,{isOpen:c,onClose:i,isCentered:!0,children:[Object(g.jsx)(k.g,{}),Object(g.jsxs)(k.d,{children:[Object(g.jsx)(k.f,{children:"Comments"}),Object(g.jsx)(k.c,{}),Object(g.jsxs)(k.b,{children:[Object(g.jsx)(l.b,{spacing:2,maxHeight:"60vh",overflowY:"scroll",className:"scroll-stack",children:null===x||void 0===x?void 0:x.comments.map((function(e){return Object(g.jsxs)(w.a,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",padding:"1rem",width:"95%",justifyContent:"space-between",alignItems:"center",children:[Object(g.jsx)(v.a,{children:e.content}),Object(g.jsx)(S.a,{cursor:"pointer",onClick:function(){return t=e.id,void u(m,t);var t}})]},e.id)}))}),0===(null===x||void 0===x?void 0:x.comments.length)&&Object(g.jsx)(v.a,{textAlign:"center",children:"Comment first!"})]}),Object(g.jsxs)(k.e,{children:[Object(g.jsx)(P.a,{placeholder:"Type your comment here...",marginRight:"1rem",value:b,onChange:function(e){return f(e.target.value)}}),Object(g.jsx)(I.a,{colorScheme:"teal",mr:3,onClick:function(){""!==b.trim()&&(d(m,b),f(""))},children:"Send"})]})]})]})]})}),ee=n(141),te=n(142),ne=function(e){var t=e.currentPage,n=e.totalCountOfMovies,c=e.handlePageChange,r=Math.ceil(n/10),i=t-1,o=t+1;return Object(g.jsxs)(l.a,{spacing:2,margin:"0.5rem",children:[Object(g.jsx)(I.a,{onClick:function(){return t>1&&c(i)},children:Object(g.jsx)(ee.a,{})}),t>1&&Object(g.jsx)(I.a,{onClick:function(){return c(1)},children:1}),t>2&&Object(g.jsx)(I.a,{onClick:function(){return c(i)},children:i}),Object(g.jsx)(I.a,{onClick:function(){return c(t)},colorScheme:"teal",children:t}),t<r-1&&Object(g.jsx)(I.a,{onClick:function(){return c(o)},children:o}),t<r&&Object(g.jsx)(I.a,{onClick:function(){return c(r)},children:r}),Object(g.jsx)(I.a,{onClick:function(){return t<r-1&&c(o)},children:Object(g.jsx)(te.a,{})})]})},ce=function(){var e=function(){var e=U();return{currentPage:X((function(e){return e.pagination.currentPage})),setCurrentPage:function(t){e(K(t))}}}(),t=e.currentPage,n=e.setCurrentPage,c=Object(r.useCallback)(function(){var e=U();return function(){var t=Object(F.a)(E.a.mark((function t(n){return E.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(A(n));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(),[]),i=Z(),o=i.movies,a=i.moviesFetchError,s=i.isLoading,h=i.totalCountOfMovies;return Object(r.useEffect)((function(){c(t)}),[t,c]),a?Object(g.jsx)(l.b,{spacing:2,padding:"1rem",children:Object(g.jsxs)(d.a,{status:"error",children:[Object(g.jsx)(d.b,{}),"There was an error fetching your movies. Try again later."]})}):Object(g.jsx)(p,{children:Object(g.jsx)(u.a,{width:"100%",minHeight:"100vh",children:"idle"===s?Object(g.jsxs)(j.a,{width:"100%",children:[Object(g.jsx)($,{movies:o}),Object(g.jsx)(ne,{currentPage:t,totalCountOfMovies:h,handlePageChange:n})]}):Object(g.jsx)(m.a,{size:"xl"})})})},re=(n(117),Object(L.a)({reducer:{moviesData:R,pagination:Q,moviesTable:Y}})),ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,152)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),i(e),o(e)}))};a.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(s.a,{store:re,children:Object(g.jsx)(c.a,{children:Object(g.jsx)(ce,{})})})}),document.getElementById("root")),ie()}},[[118,1,2]]]);
//# sourceMappingURL=main.ec22deb3.chunk.js.map